var z=Object.defineProperty;var L=(o,t,s)=>t in o?z(o,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[t]=s;var r=(o,t,s)=>L(o,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))h(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const n of i.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&h(n)}).observe(document,{childList:!0,subtree:!0});function s(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function h(e){if(e.ep)return;e.ep=!0;const i=s(e);fetch(e.href,i)}})();class O{constructor(t,s){r(this,"x");r(this,"y");this.x=t,this.y=s}draw(t,s="#ffffff"){t.fillStyle=s,t.beginPath(),t.arc(this.x,this.y,5,0,2*Math.PI),t.fill()}}class d{constructor(t,s,h,e,i="#ffffff"){r(this,"x");r(this,"y");r(this,"width");r(this,"height");r(this,"color");this.x=t,this.y=s,this.width=h,this.height=e,this.color=i}move(t,s){this.x=t,this.y=s}contains(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height}intersects(t){return!(t.x-t.width>this.x+this.width||t.x+t.width<this.x-this.width||t.y-t.height>this.y+this.height||t.y+t.height<this.y-this.height)}draw(t){t.strokeStyle=this.color,t.strokeRect(this.x,this.y,this.width,this.height)}}class l{constructor(t,s){r(this,"boundary");r(this,"capacity");r(this,"points",[]);r(this,"divided",!1);r(this,"northeast");r(this,"southeast");r(this,"northwest");r(this,"southwest");this.boundary=t,this.capacity=s}insert(t){if(!this.boundary.contains(t))return!1;if(this.points.length<this.capacity)this.points.push(t);else if(this.divided||this.subdivide(),this.northeast.insert(t)||this.northwest.insert(t)||this.southeast.insert(t)||this.southwest.insert(t))return!0;return!1}subdivide(){const t=this.boundary.x,s=this.boundary.y,h=this.boundary.width,e=this.boundary.height,i=h/2,n=e/2,b=new d(t+i,s,i,n),x=new d(t,s,i,n),q=new d(t+i,s+n,i,n),P=new d(t,s+n,i,n);this.northeast=new l(b,this.capacity),this.northwest=new l(x,this.capacity),this.southeast=new l(q,this.capacity),this.southwest=new l(P,this.capacity),this.divided=!0}query(t,s){if(!this.boundary.intersects(t))return s;for(const h of this.points)t.contains(h)&&s.push(h);return this.divided&&(this.northwest.query(t,s),this.northeast.query(t,s),this.southwest.query(t,s),this.southeast.query(t,s)),s}visualize(t){var s,h,e,i;t.strokeStyle=this.boundary.color,t.strokeRect(this.boundary.x,this.boundary.y,this.boundary.width,this.boundary.height),this.divided&&((s=this.northwest)==null||s.visualize(t),(h=this.southeast)==null||h.visualize(t),(e=this.northeast)==null||e.visualize(t),(i=this.southwest)==null||i.visualize(t))}}const a=document.querySelector("canvas"),R=document.querySelector("button"),u=a.getContext("2d"),f=devicePixelRatio||1,c=a.getBoundingClientRect();a.width=c.width*f;a.height=c.height*f;u.scale(f,f);a.style.width=`${c.width}px`;a.style.height=`${c.height}px`;const S=new d(0,0,602,602),g=new l(S,4),p=new d(c.width/2,c.height/2,200,200,"green"),v=[];let y=[],m=!1;((o,t,s)=>{for(let h=0;h<o;h++){const e=new O(Math.random()*c.width,Math.random()*c.height);t.push(e),s.insert(e)}})(256,v,g);function w(o,t,s="gray"){for(let h=0;h<o.length;h++)o[h].draw(t,s)}w(v,u);w(y,u,"red");a.addEventListener("mousemove",o=>{const t=o.offsetX,s=o.offsetY;requestAnimationFrame(()=>{u.clearRect(0,0,c.width,c.height),p.move(t,s),p.draw(u),y=[],g.query(p,y),w(v,u),w(y,u,"white"),m&&g.visualize(u)})});R.addEventListener("click",()=>{m=!m});
