var L=Object.defineProperty;var R=(r,t,s)=>t in r?L(r,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[t]=s;var n=(r,t,s)=>R(r,typeof t!="symbol"?t+"":t,s);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))e(i);new MutationObserver(i=>{for(const h of i)if(h.type==="childList")for(const a of h.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&e(a)}).observe(document,{childList:!0,subtree:!0});function s(i){const h={};return i.integrity&&(h.integrity=i.integrity),i.referrerPolicy&&(h.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?h.credentials="include":i.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function e(i){if(i.ep)return;i.ep=!0;const h=s(i);fetch(i.href,h)}})();class b{constructor(t,s){n(this,"x");n(this,"y");this.x=t,this.y=s}intersects(t,s){const e=t-this.x|0,i=s-this.y|0;return Math.sqrt(e*e+i*i)<=5}draw(t,s="#ffffff"){t.fillStyle=s,t.beginPath(),t.arc(this.x,this.y,5,0,2*Math.PI),t.fill()}}class y{constructor(t,s,e,i,h="#ffffff"){n(this,"x");n(this,"y");n(this,"width");n(this,"height");n(this,"color");this.x=t,this.y=s,this.width=e,this.height=i,this.color=h}move(t,s){this.x=t,this.y=s}resize(t,s){this.width=t,this.height=s}contains(t){return t.x>=this.x&&t.x<=this.x+this.width&&t.y>=this.y&&t.y<=this.y+this.height}intersects(t){return!(t.x-t.width>this.x+this.width||t.x+t.width<this.x-this.width||t.y-t.height>this.y+this.height||t.y+t.height<this.y-this.height)}draw(t){t.strokeStyle=this.color,t.strokeRect(this.x,this.y,this.width,this.height)}}class w{constructor(t,s){n(this,"boundary");n(this,"capacity");n(this,"points",[]);n(this,"divided",!1);n(this,"northeast");n(this,"southeast");n(this,"northwest");n(this,"southwest");this.boundary=t,this.capacity=s}insert(t){if(!this.boundary.contains(t))return!1;if(this.points.length<this.capacity)this.points.push(t);else if(this.divided||this.subdivide(),this.northeast.insert(t)||this.northwest.insert(t)||this.southeast.insert(t)||this.southwest.insert(t))return!0;return!1}subdivide(){const t=this.boundary.x,s=this.boundary.y,e=this.boundary.width,i=this.boundary.height,h=e/2,a=i/2,q=new y(t+h,s,h,a),P=new y(t,s,h,a),x=new y(t+h,s+a,h,a),z=new y(t,s+a,h,a);this.northeast=new w(q,this.capacity),this.northwest=new w(P,this.capacity),this.southeast=new w(x,this.capacity),this.southwest=new w(z,this.capacity),this.divided=!0}has(t,s){for(const e of this.points)if(e.intersects(t,s))return!0;return this.divided?this.northwest.has(t,s)||this.northeast.has(t,s)||this.southwest.has(t,s)||this.southeast.has(t,s):!1}queryByPoint(t,s,e){if(!this.boundary.contains(new b(t,s)))return e;for(const i of this.points)i.intersects(t,s)&&e.push(i);return this.divided&&(this.northwest.queryByPoint(t,s,e),this.northeast.queryByPoint(t,s,e),this.southwest.queryByPoint(t,s,e),this.southeast.queryByPoint(t,s,e)),e}query(t,s){if(!this.boundary.intersects(t))return s;for(const e of this.points)t.contains(e)&&s.push(e);return this.divided&&(this.northwest.query(t,s),this.northeast.query(t,s),this.southwest.query(t,s),this.southeast.query(t,s)),s}visualize(t){var s,e,i,h;t.strokeStyle=this.boundary.color,t.strokeRect(this.boundary.x,this.boundary.y,this.boundary.width,this.boundary.height),this.divided&&((s=this.northwest)==null||s.visualize(t),(e=this.southeast)==null||e.visualize(t),(i=this.northeast)==null||i.visualize(t),(h=this.southwest)==null||h.visualize(t))}}const u=document.querySelector("canvas"),o=u.getContext("2d"),v=devicePixelRatio||1,c=u.getBoundingClientRect();u.width=c.width*v;u.height=c.height*v;o.scale(v,v);u.style.width=`${c.width}px`;u.style.height=`${c.height}px`;const B=new y(0,0,u.width,u.height),l=new w(B,4),g=[];let d=[],p={x:0,y:0},m=!1;var O=function(){o.clearRect(0,0,c.width,c.height)},M=function(r,t,s){for(let e=0;e<r;e++){const i=new b(Math.random()*c.width|0,Math.random()*c.height|0);t.push(i),s.insert(i)}},S=function(){o.clearRect(0,0,c.width,c.height),f(g,o),f(d,o,"white")},f=function(r,t,s="gray"){for(let e=0;e<r.length;e++)r[e].draw(t,s)};M(256,g,l);f(g,o);f(d,o,"red");l.visualize(o);u.addEventListener("mousedown",r=>{const t=r.offsetX,s=r.offsetY;m=!0,p={x:t,y:s}});u.addEventListener("mousemove",r=>{const t=r.offsetX,s=r.offsetY;d=[],l.queryByPoint(t,s,d);const[e]=d;e?e.draw(o,"red"):(O(),f(g,o),l.visualize(o)),console.log(e),m&&requestAnimationFrame(()=>{o.clearRect(0,0,c.width,c.height);const i=new y(p.x,p.y,t-p.x,s-p.y,"green");l.visualize(o),i.draw(o),l.query(i,d),f(g,o),f(d,o,"red"),d=[]})});u.addEventListener("mouseup",()=>{m=!1,S(),l.visualize(o)});
